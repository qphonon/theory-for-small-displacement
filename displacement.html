
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Introduction &#8212; displacement</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Displacement method" href="title.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">displacement</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="title.html">
   Displacement method
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Introduction
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/displacement.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fdisplacement.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Introduction
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#methodology">
   Methodology
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#error-analysis-for-the-force-constants">
   Error analysis for the force constants
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#results">
   Results
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#acknowledgment">
   Acknowledgment
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix">
   Appendix
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <!---
Example of a block comment.
\begin{figure}
\centering\includegraphics[width=9.2cm,clip]{fig/2020-04-22-mpl-qphonon-det-gives-error-fit.pdf}
\label{fig:2020-04-22-mpl-qphonon-det-gives-error-fit.pdf}
\end{figure}
--->
<div class="tex2jax_ignore mathjax_ignore section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>Lattice dynamical studies<span id="id1">[<a class="reference internal" href="#id128">BH56</a>]</span> are important for an
understanding of the
phase stability,<span id="id2">[<a class="reference internal" href="#id148">GFK10</a>, <a class="reference internal" href="#id253">vdWC02</a>]</span> ferroelectric transition,<span id="id3">[<a class="reference internal" href="#id565">ZKSV94</a>]</span> Raman and
infra-red spectroscopies,<span id="id4">[<a class="reference internal" href="#id340">CXL+14</a>, <a class="reference internal" href="#id540">GCL+18</a>, <a class="reference internal" href="#id350">ZLL+13</a>]</span>
phonon-mediated superconductivity,<span id="id5">[<a class="reference internal" href="#id59">Giu17</a>]</span>
ferroelastic transition,<span id="id6">[<a class="reference internal" href="#id372">TOT08</a>]</span>
and
thermodynamics of materials.<span id="id7">[<a class="reference internal" href="#id127">Gri99</a>, <a class="reference internal" href="#id472">MRMN03</a>]</span>
Even though the concept of phonon emerges as a result of a harmonic approximation, its simple extensions
via the quasiharmonic approximation (QHA)<span id="id8">[<a class="reference internal" href="#id429">MM05</a>]</span>
and Gr”uneisen formalism<span id="id9">[<a class="reference internal" href="#id557">All20</a>, <a class="reference internal" href="#id563">MC20</a>]</span>
allow thermal properties due to anharmonic effects such as
lattice thermal conductivities<span id="id10">[<a class="reference internal" href="#id524">TPL+14</a>]</span>, a key quantity that determine the figure of merits
for thermoelectrics<span id="id11">[<a class="reference internal" href="#id548">GStevanovicT17</a>, <a class="reference internal" href="#id562">MKB16</a>, <a class="reference internal" href="#id53">ST08</a>]</span>, as well as
thermal expansion  coefficients<span id="id12">[<a class="reference internal" href="#id443">ALebegueR16</a>, <a class="reference internal" href="#id571">GC19</a>, <a class="reference internal" href="#id570">GL18</a>, <a class="reference internal" href="#id568">GL16</a>, <a class="reference internal" href="#id567">GSL15</a>, <a class="reference internal" href="#id530">Rom17</a>]</span> to be evaluated.  An attempt has been made to extract  the third order interatomic force constants from
the standard phonon calculations through the evaluation of Gr”uneisen parameters<span id="id13">[<a class="reference internal" href="#id569">LG17</a>]</span>.
Phonon databases are being built<span id="id14">[<a class="reference internal" href="#id566">PDM+18</a>, <a class="reference internal" href="#id419">Tog20a</a>]</span> with the
help of high-throughput frameworks<span id="id15">[<a class="reference internal" href="#id479">CHB+13</a>, <a class="reference internal" href="#id471">ORJ+13</a>, <a class="reference internal" href="#id470">PCS+16</a>]</span> for data mining and machine learning.</p>
<p>The methods to calculate phonon frequencies
and eigenvectors naturally fall into two distinct approaches.
One approach is based on the displacement methods<span id="id16">[<a class="reference internal" href="#id425">AWC97</a>, <a class="reference internal" href="#id415">Alfe09</a>, <a class="reference internal" href="#id148">GFK10</a>, <a class="reference internal" href="#id423">KFurthmullerH95</a>, <a class="reference internal" href="#id427">PLK97</a>, <a class="reference internal" href="#id422">TT15</a>, <a class="reference internal" href="#id420">Tog20b</a>, <a class="reference internal" href="#id555">WCL14</a>, <a class="reference internal" href="#id558">WSF+16</a>]</span> that gain popularity due to their
simplicity in implementations. In these methods,
the force constants can be deduced from the induced forces via
the Hellman-Feynman theorem<span id="id17">[<a class="reference internal" href="#id467">Fey39</a>]</span> when
a small displacement on an atom in an otherwise perfect supercell is made.
The possibility to calculate exact
phonon frequencies at commensurate <span class="math notranslate nohighlight">\(\vec{q}\)</span> vectors
using smaller non-diagonal unit cells<span id="id18">[<a class="reference internal" href="#id514">LWM15</a>]</span> paves the way for
very practical applications of these methods.
The second
approach is
based on the density-functional perturbation theory.<span id="id19">[<a class="reference internal" href="#id370">BdeGironcoliDalCorsoG01</a>, <a class="reference internal" href="#id41">Gon97</a>]</span>
In this approach, the methods are very versatile because
small unit cells rather than huge supercells
are required. Very accurate energy derivatives could be analytically calculated
within a computer code<span id="id20">[<a class="reference internal" href="#id363">GBB+09</a>, <a class="reference internal" href="#id43">GAA+09</a>]</span>.
Both approaches could be used together to
complement each other<span id="id21">[<a class="reference internal" href="#id553">FKCM19</a>]</span> for the extraction of higher-order
interatomic interactions.<span id="id22">[<a class="reference internal" href="#id426">Par18</a>]</span></p>
<p>A somewhat simple and effective implementation of
a small displacement method is to use
a few pre-selected directions in the fractional coordinates that are to be acted upon by
appropriate space group operations to deduce the displacement
directions as long as the volume <span class="math notranslate nohighlight">\(V\)</span>
spanned by the actual displacement directions is nonzero.
This strategy may have been inspired by the fact that
space group operations<span id="id23">[<a class="reference internal" href="#id384">HahnEd06</a>]</span> usually act on the
positions of atoms in fractional coordinates within a unit cell.
However, as we shall show later, such
implementation may result in a nonoptimal choice of the displacements of atoms that
affects the accuracy of the force constants and eventually the lattice dynamical
properties. We use a generic
orthorhombic system of space group <span class="math notranslate nohighlight">\(Pnma\)</span> with lattice parameters
<span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, and <span class="math notranslate nohighlight">\(c\)</span>
to show that the volume <span class="math notranslate nohighlight">\(V\)</span> may deviate from its ideal value of 1 and
scale unfavorably
as <span class="math notranslate nohighlight">\(2(a/b)^{-1} \rightarrow 0 \)</span> as  <span class="math notranslate nohighlight">\(a \gg b\)</span>.
In the case of simulating a graphene sheet using a supercell method, it is
shown that a large vacuum thickness could reduce the ideal <span class="math notranslate nohighlight">\(V=1\)</span> to
a value that scales as <span class="math notranslate nohighlight">\((c/a)^{-2}\)</span> where <span class="math notranslate nohighlight">\(c\)</span> is the vacuum height and <span class="math notranslate nohighlight">\(a\)</span> the
hexagonal lattice parameter for graphene. In this paper
we propose a displacement method that can be applied to any crystal, encompassing the
entire 32 crystallographic point groups and 230 space groups.
The displacement directions are deduced directly in the Cartesian
coordinates rather than fractional coordinates
that are designed to maintain (i) the theoretical maximum for the
triple product <span class="math notranslate nohighlight">\(V\)</span> spanned by the three displacements
to avoid possible severe roundoff errors, and (ii) a minimal set of irreducible atomic displacements for independent force calculations.
To achieve these aims we rely on the concepts of the star of <span class="math notranslate nohighlight">\(k\)</span> and the group of <span class="math notranslate nohighlight">\(k\)</span><span id="id24">[<a class="reference internal" href="#id134">DDJ08</a>]</span>, defined originally in the
reciprocal space but extended to real space in this paper.
Various test systems such as Si, graphene, and orthorhombic
\sbs{} are used to illustrate the method.
This paper is organized as follows. In Section 2
we provide the full details
of our displacement method to make judicious atomic displacements for all crystal symmetries.   Section 3
presents an error analysis for the force constants. Results are shown in Section 4. Finally we conclude in Section 5. The Appendix
A illustrates more clearly how <span class="math notranslate nohighlight">\(V\)</span> may scale poorly with the lattice parameters or the choice of
oblique unit cell for a few selected cases.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="methodology">
<h1>Methodology<a class="headerlink" href="#methodology" title="Permalink to this headline">¶</a></h1>
<p>\label{sec:method}
First we define a matrix</p>
<div class="math notranslate nohighlight" id="equation-eq-a">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-a" title="Permalink to this equation">¶</a></span>\[
A=[ \vec{a}_1|\vec{a}_2 | \vec{a}_3] 
\]</div>
<p>where
the <span class="math notranslate nohighlight">\(i\)</span>th column of <span class="math notranslate nohighlight">\(A\)</span> is taken from
the basic lattice translation vector <span class="math notranslate nohighlight">\(\vec{a}_i\)</span> of a crystal.
For simplicity
we use <span class="math notranslate nohighlight">\(A\)</span> to describe a primitive cell but it could be easily
extended to deal with a conventional unit cell or even a nonconventional
unit cell.
A space group operator <span class="math notranslate nohighlight">\(\{ R | \vec{t} \}\)</span>
(in the Seitz notation) corresponds
to a rotation matrix</p>
<div class="math notranslate nohighlight" id="equation-eq-rc">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-rc" title="Permalink to this equation">¶</a></span>\[
R_c = A^{-1} R A
\]</div>
<p>in the Cartesian coordinates, which is restricted to
either <span class="math notranslate nohighlight">\(p\)</span> or <span class="math notranslate nohighlight">\({\overline p}\)</span> for <span class="math notranslate nohighlight">\(p= 1\)</span>, <span class="math notranslate nohighlight">\(2\)</span>, <span class="math notranslate nohighlight">\(3\)</span>, <span class="math notranslate nohighlight">\(4\)</span>, and <span class="math notranslate nohighlight">\(6\)</span>.
<span class="math notranslate nohighlight">\(p\)</span> means a <span class="math notranslate nohighlight">\(p\)</span>-fold rotation in the international
notation, while <span class="math notranslate nohighlight">\( {\overline p}\)</span> means an
improper rotation (i.e., a <span class="math notranslate nohighlight">\(p\)</span>-fold rotation followed by an inversion).
The 230 space groups are built on top of
the 32 crystallographic
point groups (see e.g., Refs.~[<span id="id25">[<a class="reference internal" href="#id135">Bur85</a>, <a class="reference internal" href="#id134">DDJ08</a>]</span>]).</p>
<p>In the small displacement method<span id="id26">[<a class="reference internal" href="#id573">LCSG14</a>]</span> for
a phonon calculation of a crystal,
if the intrinsic symmetries of a
space group are not
utilized, we have to sequentially
displace all <span class="math notranslate nohighlight">\(N_1\)</span> atoms in a primitive cell
embedded in a large <span class="math notranslate nohighlight">\(n_1 \times n_2 \times n_3\)</span> supercell of
<span class="math notranslate nohighlight">\(n_1 n_2 n_3 N_1\)</span> atoms
along the <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span> Cartesian axes in
both positive and negative directions,
resulting in
<span class="math notranslate nohighlight">\(6N_1\)</span> different
supercells,
each
with one atom displaced slightly compared to the unperturbed supercell (we call this the all-displacement method).
Each of the <span class="math notranslate nohighlight">\(6N_1\)</span> supercells will be treated independently
where the induced forces are to be calculated so that
the interatomic force constants can be deduced.
Due to a computational cubic scaling with respect to the number of atoms, most density-functional theory (DFT)
implementations<span id="id27">[<a class="reference internal" href="#id559">GHP01</a>, <a class="reference internal" href="#id212">PTA+92</a>]</span> face a severe practical
issue to handle <span class="math notranslate nohighlight">\(6N_1\)</span> supercells to evaluate the induced forces. It is therefore important
to reduce the number of calculations as much as possible.</p>
<p>We now review how the force constant matrix <span class="math notranslate nohighlight">\(\Psi_{ij}\)</span>
between
the <span class="math notranslate nohighlight">\(i\)</span>th atom in the primitive cell and the <span class="math notranslate nohighlight">\(j\)</span>th atom in the
supercell may be calculated.
This is achieved by sequentially displacing the <span class="math notranslate nohighlight">\(i\)</span>th
atom in the primitive cell by three displacement vectors <span class="math notranslate nohighlight">\(\lambda \vec{d}_k^i\)</span> in the
Cartesian coordinates, <span class="math notranslate nohighlight">\(k = 1, 2, 3\)</span>, where
<span class="math notranslate nohighlight">\(\vec{d}_k^i\)</span> is a unit vector.
<span class="math notranslate nohighlight">\(\lambda\)</span> is the magnitude of the displacement which is typically
<span class="math notranslate nohighlight">\(0.010 \sim 0.015\)</span>~\AA.
For each displacement vector <span class="math notranslate nohighlight">\(\lambda \vec{d}_k^i\)</span>,
we calculate the induced forces
on all atoms in the supercell, in particular the induced force
<span class="math notranslate nohighlight">\(\vec{F}_k^j\)</span> on the <span class="math notranslate nohighlight">\(j\)</span>th atom, <span class="math notranslate nohighlight">\(k=1,2,3\)</span>.
If we make <span class="math notranslate nohighlight">\(\vec{F}_k^j\)</span> to
constitute the <span class="math notranslate nohighlight">\(k\)</span>th column of a matrix <span class="math notranslate nohighlight">\(F^j\)</span> where</p>
<div class="math notranslate nohighlight" id="equation-eq-fj">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-fj" title="Permalink to this equation">¶</a></span>\[
F^j = [\vec{F}_1^j | \vec{F}_2^j | \vec{F}_3^j ]
\]</div>
<p>and similarly we
let <span class="math notranslate nohighlight">\(\vec{d}_k^i\)</span> to constitute the <span class="math notranslate nohighlight">\(k\)</span>th column of a displacement matrix <span class="math notranslate nohighlight">\(d^i\)</span> where</p>
<div class="math notranslate nohighlight" id="equation-eq-dmat">
<span class="eqno">(4)<a class="headerlink" href="#equation-eq-dmat" title="Permalink to this equation">¶</a></span>\[
d^i = [\vec{d}_1^i | \vec{d}_2^i | \vec{d}_3^i] 
\]</div>
<p>then the required force constant <span class="math notranslate nohighlight">\(\Phi_{ij}\)</span> can be calculated from</p>
<div class="math notranslate nohighlight" id="equation-eq-phi">
<span class="eqno">(6)<a class="headerlink" href="#equation-eq-phi" title="Permalink to this equation">¶</a></span>\[
F^j = \lambda \Phi_{ij} d^i
\]</div>
<p>From Eq.<a class="reference internal" href="#equation-eq-phi">(6)</a>
we see that the displacement vectors <span class="math notranslate nohighlight">\(\vec{d}_k^i\)</span> do not
need to point along the conventional Cartesian axes but in
any directions as long as <span class="math notranslate nohighlight">\(d^i\)</span> is not singular.</p>
<p>A first level of a possible reduction of the number of calculations can be made
if an inequivalent atom in the primitive cell,
where its position is commonly known
as the Wyckoff position,
could be mapped under space group operations
to its equivalent atoms in the primitive cell, resulting in a
star of <span class="math notranslate nohighlight">\(k\)</span>, which is understood to be a set of atoms.
We note that the concept of the star of <span class="math notranslate nohighlight">\(k\)</span> is originally defined in
the reciprocal space<span id="id28">[<a class="reference internal" href="#id134">DDJ08</a>]</span>.
When handling a star of <span class="math notranslate nohighlight">\(k\)</span>, we may arbitrarily choose
any atom in a set to be a representative atom (the so-called
inequivalent atom) for the
purpose of generating the rest of equivalent atoms in the same set.
The <span class="math notranslate nohighlight">\(3\times 3\)</span> force constant matrix <span class="math notranslate nohighlight">\(\Phi_{ij}\)</span>
between the <span class="math notranslate nohighlight">\(i\)</span>th inequivalent atom in the
primitive cell and another <span class="math notranslate nohighlight">\(j\)</span>th atom in the supercell
can be ``copied’’ out<span id="id29">[<a class="reference internal" href="#id573">LCSG14</a>]</span> to
another <span class="math notranslate nohighlight">\(3\times 3\)</span> force constant matrix <span class="math notranslate nohighlight">\(\Phi_{i'j'}\)</span> between
the <span class="math notranslate nohighlight">\(i'\)</span>th equivalent atom and the <span class="math notranslate nohighlight">\(j'\)</span>th atom using</p>
<div class="math notranslate nohighlight" id="equation-eq-phi">
<span class="eqno">(6)<a class="headerlink" href="#equation-eq-phi" title="Permalink to this equation">¶</a></span>\[
\Phi_{i'j'} =  R_c \Phi_{ij} R_c^T
\]</div>
<p><span class="math notranslate nohighlight">\(R_c\)</span> is as defined in Eq.<a class="reference internal" href="#equation-eq-rc">(2)</a> and <span class="math notranslate nohighlight">\( \{ R | \vec{t} \}  \)</span>
maps the <span class="math notranslate nohighlight">\(i\)</span>th atom to the <span class="math notranslate nohighlight">\(i'\)</span>th atom, and
the <span class="math notranslate nohighlight">\(j\)</span>th atom to the <span class="math notranslate nohighlight">\(j'\)</span>th atom.  <span class="math notranslate nohighlight">\(R_c^T\)</span> is the matrix transpose of <span class="math notranslate nohighlight">\(R_c\)</span>.
With this strategy alone (we call this the 6-displacement method),
if there are <span class="math notranslate nohighlight">\(N_0\)</span> inequivalent atoms in a primitive cell,
then only <span class="math notranslate nohighlight">\(6 N_0\)</span> calculations are needed.</p>
<p>However, it may still be possible to reduce the 6 calculations for each
of <span class="math notranslate nohighlight">\(N_0\)</span> inequivalent atoms using the
site symmetry<span id="id30">[<a class="reference internal" href="#id135">Bur85</a>]</span> of an inequivalent atom. The
site symmetry (this has the equivalent concept of the group of <span class="math notranslate nohighlight">\(k\)</span>, see
for example Ref.~[\onlinecite{Altmann-book}]) of an inequivalent
atom is one of the 32
crystallographic point groups that
leaves the position of an inequivalent atom invariant in periodic
sense.  Note that two different inequivalent atoms from two different
stars of <span class="math notranslate nohighlight">\(k\)</span> may not have the same site symmetries.</p>
<p>Now we shall discuss how the site symmetry can be used
to reduce the number of displacements for an inequivalent atom.
Suppose a displacement <span class="math notranslate nohighlight">\(\vec{d}_1^i\)</span> has been applied to an inequivalent
<span class="math notranslate nohighlight">\(i\)</span>th atom and the forces on all atoms in the supercell have been found.
If an element <span class="math notranslate nohighlight">\(\{R|\vec{t}\}\)</span> in the site symmetry of the <span class="math notranslate nohighlight">\(i\)</span>th
atom is applied to the supercell with the <span class="math notranslate nohighlight">\(i\)</span>th atom that has been displaced by
<span class="math notranslate nohighlight">\(\vec{d}_1^i\)</span>, then the net effect of the operation
is to rotate the original displacement
<span class="math notranslate nohighlight">\(\vec{d}_1^i\)</span> to become a displacement <span class="math notranslate nohighlight">\(\vec{d}_2^i = R_c \vec{d}_1^i\)</span>
on the <span class="math notranslate nohighlight">\(i\)</span>th atom.  The operation <span class="math notranslate nohighlight">\(\{R|\vec{t}\}\)</span> also reshuffles
the positions of all atoms in the supercell, as well as to rotate the
induced forces caused by <span class="math notranslate nohighlight">\(\vec{d}_1^i\)</span> on all atoms in the supercell. This
crucial observation implies
that without doing an independent (probably expensive)
induced force calculation
due to <span class="math notranslate nohighlight">\(\vec{d}_2^i\)</span>, we are able to just use the information due to
<span class="math notranslate nohighlight">\(\vec{d}_1^i\)</span> to give us all force information for
a virtual <span class="math notranslate nohighlight">\(\vec{d}_2^i\)</span> displacement.<br />
If there is yet another operation <span class="math notranslate nohighlight">\(\{R|\vec{t}\}\)</span> that could
rotate <span class="math notranslate nohighlight">\(\vec{d}_1^i\)</span> to <span class="math notranslate nohighlight">\(\vec{d}_3^i\)</span>, then again an independent displacement
of <span class="math notranslate nohighlight">\(\vec{d}_3^i\)</span> does not need to be carried out.  However, in the case when
there is no extra operation in a site symmetry that can
generate an independent <span class="math notranslate nohighlight">\(\vec{d}_2^i\)</span> or <span class="math notranslate nohighlight">\(\vec{d}_3^i\)</span>,
then we have no choice
but to carry out necessary separate displacements and find the induced
forces to fill up the necessary force field for the <span class="math notranslate nohighlight">\(\Phi_{ij}\)</span> calculation.</p>
<p>In an elegant implementation, the displacement in the Cartesian
coordinates <span class="math notranslate nohighlight">\(\vec{d}^i_k\)</span> can be generated from the directions defined
in the fractional coordinates <span class="math notranslate nohighlight">\(\vec{g}_k^i\)</span> where
<span class="math notranslate nohighlight">\( \vec{d}^i_k =  \frac{A \vec{g}_k^i}{ |  A \vec{g}_k^i  |   }\)</span>.<br />
<span class="math notranslate nohighlight">\(\vec{g}_{k}^i\)</span> may be chosen from a set of <span class="math notranslate nohighlight">\(S\)</span>
that consists of \emph{nonzero}
vectors of the form <span class="math notranslate nohighlight">\( (e_1, e_2, e_3)^T\)</span>, where <span class="math notranslate nohighlight">\(e_n = 0, \pm
1\)</span> for <span class="math notranslate nohighlight">\(n= 1,2,3\)</span> for simplicity.  By systematically applying the elements
of the site symmetry to vectors in <span class="math notranslate nohighlight">\(S\)</span>, one may find a minimal set
<span class="math notranslate nohighlight">\(S_i\)</span> that contains between one to three vectors.
<span class="math notranslate nohighlight">\(S_i\)</span> will generate three <span class="math notranslate nohighlight">\(\vec{g}_k^i\)</span> that form a nonzero determinant for <span class="math notranslate nohighlight">\(d^i\)</span>.
This implementation has a slight drawback that may be illustrated by
two similar
orthorhombic systems Bi<span class="math notranslate nohighlight">\(_2\)</span>S<span class="math notranslate nohighlight">\(_3\)</span><span id="id31">[<a class="reference internal" href="#id61">ZCG+11</a>]</span> and
\sbs<span id="id32">[<a class="reference internal" href="#id340">CXL+14</a>, <a class="reference internal" href="#id567">GSL15</a>, <a class="reference internal" href="#id573">LCSG14</a>]</span>
in the <span class="math notranslate nohighlight">\(Pnma\)</span> setting, where <span class="math notranslate nohighlight">\(a \sim 11.3\)</span>~\AA, <span class="math notranslate nohighlight">\(b \sim 3.8 \)</span>~\AA, and <span class="math notranslate nohighlight">\(c \sim
11.1\)</span>~\AA. Here <span class="math notranslate nohighlight">\(a\)</span> is about three times larger than <span class="math notranslate nohighlight">\(b\)</span>.<br />
There are twenty atoms in the primitive cell, with
five inequivalent atoms on the <span class="math notranslate nohighlight">\(4c\)</span> Wyckoff site.
The site symmetry is a group of mirror reflection (a two-element group).
The reflection operator <span class="math notranslate nohighlight">\(\overline{2}\)</span>
reflects the system
across the <span class="math notranslate nohighlight">\(xz\)</span> plane and maps a direction in
the fractional coordinate
<span class="math notranslate nohighlight">\( \vec{g}_1^i = (1,-1,0)^T \)</span> to <span class="math notranslate nohighlight">\( \vec{g}_2^i = (1,1,0)^T\)</span>.
However, these two directions in the fractional coordinates correspond to
<span class="math notranslate nohighlight">\((a,-b,0)^T\)</span> and <span class="math notranslate nohighlight">\((a,b,0)^T\)</span> in the Cartesian coordinates which
subtend an angle not equal to an ideal
angle of <span class="math notranslate nohighlight">\(90^\circ\)</span> since <span class="math notranslate nohighlight">\(a \neq b\)</span>.
The angle between the two displacements in
the Cartesian coordinates is actually
given by <span class="math notranslate nohighlight">\(2\tan^{-1}{\frac{b}{a}}\)</span> (see Appendix A for a detailed discussion).
Hence if <span class="math notranslate nohighlight">\(a\)</span> is much larger than <span class="math notranslate nohighlight">\(b\)</span>, the two vectors <span class="math notranslate nohighlight">\(\vec{d}_1^i\)</span>
and <span class="math notranslate nohighlight">\(\vec{d}_2^i\)</span> are nearly parallel to each other in the Cartesian coordinates.
However the operation is a physical reflection in the <span class="math notranslate nohighlight">\(xz\)</span> plane and
hence it is possible to force the angle between the two displaced vectors
to be exactly <span class="math notranslate nohighlight">\(90^\circ\)</span>, thereby achieving the largest
determinant for <span class="math notranslate nohighlight">\(d^i\)</span> of <span class="math notranslate nohighlight">\(1\)</span> for matrix inversion in Eq.~\ref{eq:Phi}.</p>
<p>In another example, a graphene sheet of
a lattice constant <span class="math notranslate nohighlight">\(a\)</span> and a vacuum thickness <span class="math notranslate nohighlight">\(c\)</span> may use <span class="math notranslate nohighlight">\(\vec{g}_1^i =
(1,0,1)^T\)</span> to generate <span class="math notranslate nohighlight">\(\vec{g}_2^i = (0, 1, -1)^T\)</span> and <span class="math notranslate nohighlight">\(\vec{g}_3^i = 
(-1,-1,1)^T\)</span> with the point group operations.
This means only one independent force calculation is to be performed.
However, an analysis shows that <span class="math notranslate nohighlight">\(V = \det d^i = \frac{ a^2 c \sqrt3  }{ 2(a^2 + c^2)^{3/2}   }\)</span>, which
goes to <span class="math notranslate nohighlight">\(\frac{\sqrt3/2}{(c/a)^2}\)</span>
for a large <span class="math notranslate nohighlight">\(c/a\)</span> ratio. With<span id="id33">[<a class="reference internal" href="#id309">GS10</a>]</span> <span class="math notranslate nohighlight">\(c=20\)</span>~\AA{} and <span class="math notranslate nohighlight">\(a = 2.471\)</span>~\AA{},
<span class="math notranslate nohighlight">\(V = 0.013\)</span>. However, with the method to be developed later,
we find that the angles between any two displacements taken from <span class="math notranslate nohighlight">\(\vec{d}_k^i\)</span>, <span class="math notranslate nohighlight">\(k=1,2,3\)</span>
can be made <span class="math notranslate nohighlight">\(90^\circ\)</span> thereby making <span class="math notranslate nohighlight">\(V\)</span> achieves its largest
value of 1.</p>
<p>To develop a sense of how the inaccuracy of forces and
<span class="math notranslate nohighlight">\(V = \det d^i\)</span> may affect the
accuracy of force constants, we consider the force constants in the
<span class="math notranslate nohighlight">\(xy\)</span> plane for the <span class="math notranslate nohighlight">\(4c\)</span> site of the
<span class="math notranslate nohighlight">\(Pnma\)</span> space group. Here <span class="math notranslate nohighlight">\(\vec{d}_1^i = \frac{1}{\sqrt{a^2 + b^2}}(a,-b)^T\)</span>
and <span class="math notranslate nohighlight">\(\vec{d}_2^i = \frac{1}{\sqrt{a^2+ b^2}}(a,b)^T\)</span>.
From Eq.~\ref{eq:Phi}, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
[\vec{F}_1^j | \vec{F}_2^j ] = \lambda [\Phi_{ij}^1| \Phi_{ij}^2] 
\frac{1}{\sqrt{a^2 + b^2}}
  \begin{pmatrix}
       a &amp;  a \\
       -b &amp;  b \\
  \end{pmatrix}
\end{split}\]</div>
<p>We then have</p>
<div class="math notranslate nohighlight">
\[
\Phi_{ij}^2 = \frac{1}{2\lambda} \left( \frac{a^2}{b^2}  +1 \right)^{\frac{1}{2}}
 (\vec{F}_2^j -  \vec{F}_1^j)
\]</div>
<p>If <span class="math notranslate nohighlight">\(a \gg b\)</span>, then
<span class="math notranslate nohighlight">\(\vec{d}_1^i\)</span> and <span class="math notranslate nohighlight">\(\vec{d}_2^i\)</span> are almost parallel to each other resulting in
very similar forces <span class="math notranslate nohighlight">\(\vec{F}_1^j\)</span> and <span class="math notranslate nohighlight">\(\vec{F}_2^j\)</span>.
If the force <span class="math notranslate nohighlight">\(\vec{F}_1^j\)</span> due to <span class="math notranslate nohighlight">\(\vec{d}_1^i\)</span> is not
determined accurate enough, <span class="math notranslate nohighlight">\(\vec{F}_2^j\)</span> will inherit the same inaccuracy since it
is `copied’ from <span class="math notranslate nohighlight">\(\vec{F}_1^j\)</span> through a symmetry operation, then
<span class="math notranslate nohighlight">\(\Phi_{ij}^2\)</span> will be inaccurate due to a large roundoff error that is amplified by
a large geometry factor <span class="math notranslate nohighlight">\( \left( \frac{a^2}{b^2}  +1 \right)^{\frac{1}{2}}\)</span>.</p>
<p>Now we present a method
that will systematically deduce the displacement directions
directly in the \emph{Cartesian coordinates} for a
forward difference scheme with the aim of
maintaining a largest possible magnitude for the determinant of <span class="math notranslate nohighlight">\(d^i\)</span> and
a minimum number of independent displacements.
The displacement method
must also maintain the minimal number of independent displacements when a
central difference scheme is used for an improved accuracy for <span class="math notranslate nohighlight">\(\Phi_{ij}\)</span>.
For a central difference scheme, we need to displace the atoms
in <span class="math notranslate nohighlight">\(-\vec{d}_k^i\)</span>, <span class="math notranslate nohighlight">\(k = 1, 2, 3\)</span> where <span class="math notranslate nohighlight">\(\vec{d}_k^i\)</span> have been chosen
for a forward difference scheme. We note that two operations
are able to map <span class="math notranslate nohighlight">\(\vec{d}_k^i\)</span> to <span class="math notranslate nohighlight">\(-\vec{d}_k^i\)</span>: one is the inversion
operator, and the other a
2-fold rotation.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Crystal</p></th>
<th class="head"><p>Symmetry</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(n_{\rm FD}\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(n_{\rm CD}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>Triclinic</p></td>
<td><p><span class="math notranslate nohighlight">\(C_1\)</span></p></td>
<td><p>3</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(C_i\)</span></p></td>
<td><p>3</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Monoclinic</p></td>
<td><p><span class="math notranslate nohighlight">\(C_2\)</span></p></td>
<td><p>2</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(C_{s}\)</span></p></td>
<td><p>2</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(C_{2h}\)</span></p></td>
<td><p>2</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Orthorhombic</p></td>
<td><p><span class="math notranslate nohighlight">\(D_2\)</span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(C_{2v}\)</span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(D_{2h}\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Tetragonal</p></td>
<td><p><span class="math notranslate nohighlight">\(C_4\)</span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(S_4\)</span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(C_{4h}\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(D_4\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(C_{4v}\)</span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(D_{2d}\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(D_{4h}\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Trigonal</p></td>
<td><p><span class="math notranslate nohighlight">\(C_3\)</span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(S_6\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(D_3\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(C_{3v}\)</span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(D_{3d}\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Hexagonal</p></td>
<td><p><span class="math notranslate nohighlight">\(C_{6}\)</span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(C_{3h}\)</span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(C_{6h}\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(D_{6}\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(C_{6v}\)</span></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(D_{3h}\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(D_{6h}\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Cubic</p></td>
<td><p><span class="math notranslate nohighlight">\(T\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(T_h\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(O\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(T_d\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p></p></td>
<td><p><span class="math notranslate nohighlight">\(O_h\)</span></p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p>Table1: <span class="math notranslate nohighlight">\(n_{\rm CD}\)</span> (<span class="math notranslate nohighlight">\(n_{\rm FD}\)</span>) is the minimal number of displacements per atom for a central (forward) difference scheme.</p>
<p>The task may at first seem arduous for all 32 crystallographic
point groups (see Table 1). However, there are actually
four distinct cases to consider. (See
an implementation of our algorithm in fm-forces.f90
from <a class="reference external" href="https://github.com/qphonon/atomic-displacement">https://github.com/qphonon/atomic-displacement</a>)
The first case deals with
the triclinic crystals and covers
point groups 1 to 2 (<span class="math notranslate nohighlight">\(C_1\)</span> and <span class="math notranslate nohighlight">\(C_i\)</span>)
that involve a single <span class="math notranslate nohighlight">\(1\)</span> or <span class="math notranslate nohighlight">\({\overline 1}\)</span> operation.<br />
The second case handles the monoclinic crystals and covers
point groups 3 to 5 (<span class="math notranslate nohighlight">\(C_2\)</span>, <span class="math notranslate nohighlight">\(C_s\)</span>, <span class="math notranslate nohighlight">\(C_{2h}\)</span>)
that involve a single <span class="math notranslate nohighlight">\(2\)</span>  or <span class="math notranslate nohighlight">\({\overline 2}\)</span> operation.
The third case deals with the orthorhombic
crystals and covers point groups 6 to 8  (<span class="math notranslate nohighlight">\(D_2\)</span>, <span class="math notranslate nohighlight">\(C_{2v}\)</span>, <span class="math notranslate nohighlight">\(D_{2h}\)</span>).
These point groups possess
three operations involving
either <span class="math notranslate nohighlight">\(2 \)</span> or <span class="math notranslate nohighlight">\({\overline 2}\)</span> that are perpendicular
to one another.
Finally the fourth case
deals with the remaining four crystal systems, i.e.,
tetragonal, trigonal, hexagonal, and cubic crystals and covers
point groups 9 to 32.
These point groups have a single <span class="math notranslate nohighlight">\(3\)</span>, <span class="math notranslate nohighlight">\({\overline 3}\)</span>, <span class="math notranslate nohighlight">\(4\)</span>,
or <span class="math notranslate nohighlight">\({\overline 4}\)</span> operation.</p>
<p>Usually, the principal axis (the axis with the highest symmetry)
is not pointing along the <span class="math notranslate nohighlight">\(z\)</span> axis but
along a vector <span class="math notranslate nohighlight">\(\vec{n}\)</span> characterized by
the polar angle <span class="math notranslate nohighlight">\(\theta\)</span> and azimuthal angle <span class="math notranslate nohighlight">\(\phi\)</span>.
To ease the discussion of the determination
of <span class="math notranslate nohighlight">\(\vec{d}_k^i\)</span>, we
transform all operations <span class="math notranslate nohighlight">\(R_c\)</span> to <span class="math notranslate nohighlight">\(R_c'\)</span>  in the site symmetry according to
<span class="math notranslate nohighlight">\(R_c' = Q^{-1} R_c Q\)</span>, <span class="math notranslate nohighlight">\(Q = R_z(\phi) R_y(\theta)\)</span>. Here
<span class="math notranslate nohighlight">\(R_y (\theta) \)</span> [<span class="math notranslate nohighlight">\(R_z (\phi)\)</span>]
is a rotation of angle <span class="math notranslate nohighlight">\(\theta\)</span> (<span class="math notranslate nohighlight">\(\phi\)</span>) around the <span class="math notranslate nohighlight">\(y\)</span> (<span class="math notranslate nohighlight">\(z\)</span>) axis.
Under such transformation, the operation with the
principal axis <span class="math notranslate nohighlight">\(R_{\vec{n}}(\eta)\)</span>  will be mapped to
<span class="math notranslate nohighlight">\(R_z(\eta)\)</span> where the rotation axis is now along the <span class="math notranslate nohighlight">\(z\)</span> axis.
This can be easily seen since <span class="math notranslate nohighlight">\(R_{\vec{n}}(\eta)\)</span> is transformed to
<span class="math notranslate nohighlight">\( R_z(\eta) \)</span> via <span class="math notranslate nohighlight">\(R_{z}(\eta) = Q^{-1} R_{\vec{n}}(\eta) Q\)</span> or
<span class="math notranslate nohighlight">\( R_{\vec{n}}(\eta) = Q R_{z}(\eta)  Q^{-1}\)</span>.
Once we find <span class="math notranslate nohighlight">\(\vec{d'}_k^i\)</span> in the rotated frame,
we obtain <span class="math notranslate nohighlight">\(\vec{d}_k^i = Q \vec{d'}^{i}_k\)</span>.</p>
<p>\subsection{The first case}
First we consider the triclinic cell where there are two point groups <span class="math notranslate nohighlight">\(C_1 (1)\)</span> and <span class="math notranslate nohighlight">\(C_i ({\overline 1})\)</span>.
For <span class="math notranslate nohighlight">\(C_1 (1)\)</span> the symmetry is so low that
we simply propose to displace the <span class="math notranslate nohighlight">\(i\)</span>th atom in <span class="math notranslate nohighlight">\(x+\)</span>, <span class="math notranslate nohighlight">\(y+\)</span>, and <span class="math notranslate nohighlight">\(z+\)</span>, resulting in three independent displacements for
a forward difference scheme.
In this case, <span class="math notranslate nohighlight">\(V = \det d^i\)</span> attains its largest possible value of unity.
For a central difference scheme, we need to displace the atom
in <span class="math notranslate nohighlight">\(x-\)</span>, <span class="math notranslate nohighlight">\(y-\)</span>, and <span class="math notranslate nohighlight">\(z-\)</span>, resulting
a total of six displacements.
For <span class="math notranslate nohighlight">\( C_i ({\overline 1})\)</span>, an
inversion operator exists that could map <span class="math notranslate nohighlight">\(\vec{d'}_k^i\)</span> to <span class="math notranslate nohighlight">\(-\vec{d'}_k^i\)</span>
hence we need to do the same number of displacements (i.e., <span class="math notranslate nohighlight">\(3\)</span>)
for
both the forward and central difference schemes (see the third
row of Table 1.</p>
<p>\subsection{The second case}
For the monoclinic cell there are three point groups to consider.  We first
consider <span class="math notranslate nohighlight">\(C_2 (2)\)</span>, we propose to use a
first displacement <span class="math notranslate nohighlight">\(\vec{d'}^i_1 =
(0,-1,1)^T\)</span>. Under a 2-fold rotation around the <span class="math notranslate nohighlight">\(z\)</span> axis,
we generate a second displacement
<span class="math notranslate nohighlight">\(\vec{d'}_2^i = (0, 1,1)^T\)</span> from <span class="math notranslate nohighlight">\(\vec{d'}_1^i\)</span>.
We exhaust all operations in this point group,
hence we propose a second independent displacement vector
<span class="math notranslate nohighlight">\(\vec{d'}_3^i = (1,0,0)^T\)</span>.<br />
This choice makes <span class="math notranslate nohighlight">\(V\)</span> to attain its largest possible value of unity.
For a central difference scheme, we need
to displace the <span class="math notranslate nohighlight">\(i\)</span>th atom in <span class="math notranslate nohighlight">\(-\vec{d'}_1^i\)</span> independently
since there is no operation in the site symmetry
that is able to map <span class="math notranslate nohighlight">\(\vec{d'}_1^i\)</span> to its negative.
However, the 2-fold rotation
is able to map <span class="math notranslate nohighlight">\(\vec{d'}_3^i = (1,0,0)^T\)</span> to its negative <span class="math notranslate nohighlight">\((-1,0,0)^T\)</span>.
Hence the total number of
displacements is three for the point group <span class="math notranslate nohighlight">\(C_2(2)\)</span> instead of four for a central difference scheme.<br />
For the second point group <span class="math notranslate nohighlight">\(C_{s} (m)\)</span>. There is no
operation that can map <span class="math notranslate nohighlight">\(\vec{d'}_1^i\)</span> and <span class="math notranslate nohighlight">\(\vec{d'}_3^i\)</span>
to their negatives. Hence the number of independent displacements is
four for a central difference scheme.
The third point group to consider is <span class="math notranslate nohighlight">\(C_{2h}\)</span>. Since there is an inversion operator
the number of displacements
for the forward and central difference schemes are the same, which is two.</p>
<p>\subsection{The third case}
For the next three point groups for the orthorhombic cells <span class="math notranslate nohighlight">\(D_2 (222)\)</span>,
<span class="math notranslate nohighlight">\(C_{2v} (mm2)\)</span>, and <span class="math notranslate nohighlight">\(D_{2h}(mmm)\)</span>, we simply need to displace an atom
in <span class="math notranslate nohighlight">\(\vec{d'}_1^i = \frac{1}{\sqrt{3}} (1,1,1)\)</span> direction.  This direction is obtained by
maximizing a test vector <span class="math notranslate nohighlight">\((t,u,v)^T\)</span> and its images <span class="math notranslate nohighlight">\((t,-u,-v)\)</span> (under a
<span class="math notranslate nohighlight">\(2\)</span>-fold rotation around the <span class="math notranslate nohighlight">\(x\)</span>-axis) and <span class="math notranslate nohighlight">\((-t,u,-v)\)</span> (under a <span class="math notranslate nohighlight">\(2\)</span>-fold
rotation around the <span class="math notranslate nohighlight">\(y\)</span>-axis) thus forming a triple product of <span class="math notranslate nohighlight">\( V = 4tuv\)</span>. The magnitude of the displacement vector
is constrained according to
<span class="math notranslate nohighlight">\(t^2+ u^2 +v^2 = 1\)</span>. A standard Lagrange multiplier method
gives a possible solution
<span class="math notranslate nohighlight">\(\vec{d'}_1^i = \frac{1}{\sqrt{3}} (1,1,1)^T\)</span>
that delivers the largest <span class="math notranslate nohighlight">\(V = \frac{4}{\sqrt{27}} = 0.7698\)</span>.</p>
<p>For <span class="math notranslate nohighlight">\(D_2\)</span> and <span class="math notranslate nohighlight">\(C_{2v}\)</span> there is no
operation that could map <span class="math notranslate nohighlight">\(\vec{d'}_1^i\)</span> to <span class="math notranslate nohighlight">\(-\vec{d'}_1^i\)</span>
hence we need to do
a total of two
displacements for a central difference scheme.<br />
However, <span class="math notranslate nohighlight">\(D_{2h}\)</span> has an inversion operator
that results in the same number (i.e., one)
of independent displacement
for both the forward and central difference schemes.</p>
<p>\subsection{The fourth case}
For the next 24 point groups from <span class="math notranslate nohighlight">\(C_4 (4)\)</span> to <span class="math notranslate nohighlight">\(O_h (m{\overline 3}m)\)</span>
covering tetragonal, trigonal, hexagonal, and cubic cells, we note
that we have either <span class="math notranslate nohighlight">\(3\)</span> or <span class="math notranslate nohighlight">\({\overline 3}\)</span> or <span class="math notranslate nohighlight">\(4\)</span> or <span class="math notranslate nohighlight">\({\overline 4}\)</span> that
is able to generate <span class="math notranslate nohighlight">\(\vec{d'}_2^i\)</span> and <span class="math notranslate nohighlight">\(\vec{d'}_3^i\)</span> from just one
<span class="math notranslate nohighlight">\(\vec{d'}_1^i\)</span>.
For these point groups, using the Lagrange multiplier method, we find
that a single displacement is able to give a maximum <span class="math notranslate nohighlight">\(V\)</span> of
<span class="math notranslate nohighlight">\(\frac{4}{\sqrt{27}}\)</span> and <span class="math notranslate nohighlight">\(1\)</span> for <span class="math notranslate nohighlight">\(C_4\)</span> and <span class="math notranslate nohighlight">\(C_3\)</span>, respectively,  with a
test vector of <span class="math notranslate nohighlight">\(\vec{d'}_1^i = (t,u,\frac{1}{\sqrt{3}})^T\)</span>, <span class="math notranslate nohighlight">\(t^2 + u^2
= \frac{2}{3}\)</span>.  In order to prepare <span class="math notranslate nohighlight">\( \vec{d'}_1^i \)</span> to be mapped under
an existing <span class="math notranslate nohighlight">\(C_2\)</span> operation (which is unfortunately
missing in eight point groups <span class="math notranslate nohighlight">\(C_4\)</span>, <span class="math notranslate nohighlight">\(S_4\)</span>, <span class="math notranslate nohighlight">\(C_{4v}\)</span>, <span class="math notranslate nohighlight">\(C_3\)</span>,
<span class="math notranslate nohighlight">\(C_{3v}\)</span>, <span class="math notranslate nohighlight">\(C_6\)</span>, <span class="math notranslate nohighlight">\(C_{3h}\)</span>, and <span class="math notranslate nohighlight">\(C_{6v}\)</span>)
to <span class="math notranslate nohighlight">\( - \vec{d'}_1^i \)</span>
with the <span class="math notranslate nohighlight">\(C_2\)</span> rotation axis pointing along <span class="math notranslate nohighlight">\((n_x, n_y, n_z)\)</span>
direction, we can find the values of <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(u\)</span>
by solving the simultaneous equations
<span class="math notranslate nohighlight">\(t^2 + u^2 = \frac{2}{3}\)</span> and <span class="math notranslate nohighlight">\(n_x t + n_y u + \frac{n_z}{\sqrt{3}} = 0\)</span>.
This is equivalent to solving a quadratic equation <span class="math notranslate nohighlight">\((n_x^2 +
n_y^2) u^2 + \frac{2}{\sqrt{3}} n_y n_z u + \frac{1}{3} \left( n_z^2 -
2n_x^2\right) = 0\)</span>.
To see more clearly the nature of solutions to the quadratic equation,
without loss of generality we assume the axis of rotation for
<span class="math notranslate nohighlight">\(C_2\)</span> is in the <span class="math notranslate nohighlight">\(yz\)</span> plane making an angle
<span class="math notranslate nohighlight">\(\theta\)</span> with the <span class="math notranslate nohighlight">\(z\)</span> axis where <span class="math notranslate nohighlight">\((n_x, n_y, n_z) = 
(0,\sin\theta,\cos\theta)\)</span>. This gives
two solutions <span class="math notranslate nohighlight">\((t,u,v) = (\pm \sqrt{1- \frac{1}{3\sin^2\theta}}, - \frac{\cos\theta}{\sqrt{3} \sin \theta}, \sqrt{\frac{1}{3}})\)</span>.
For <span class="math notranslate nohighlight">\(\theta = \frac{\pi}{2}\)</span>, <span class="math notranslate nohighlight">\((t,u,v) = 
( \pm \sqrt{ \frac{2}{3}  }, 0, \sqrt{\frac{1}{3}})\)</span>.<br />
As <span class="math notranslate nohighlight">\(\theta\)</span> is decreased from <span class="math notranslate nohighlight">\(\frac{\pi}{2}\)</span>,
two solutions will approach one another along the circumference
of a circle and coincide with one another
when <span class="math notranslate nohighlight">\(\theta \)</span> becomes a critical
angle <span class="math notranslate nohighlight">\(\theta_c  = \sin^{-1} \sqrt{\frac{1}{3}} = 35.26^\circ\)</span>
and the solution is <span class="math notranslate nohighlight">\((t,u,v) = ( 0, -\sqrt{\frac{2}{3}}, \sqrt{\frac{1}{3}}   )\)</span>.
When  <span class="math notranslate nohighlight">\(\theta &lt; \theta_c\)</span>, there is no real solution.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="error-analysis-for-the-force-constants">
<h1>Error analysis for the force constants<a class="headerlink" href="#error-analysis-for-the-force-constants" title="Permalink to this headline">¶</a></h1>
<p>\label{sec:FC_error}
Now we perform a detailed
error analysis for the displacement method. We shall
focus on <span class="math notranslate nohighlight">\(\Phi_{ij}\)</span> which is
the <span class="math notranslate nohighlight">\(3\times 3\)</span> force constant matrix block between
the <span class="math notranslate nohighlight">\(i\)</span>th atom and the <span class="math notranslate nohighlight">\(j\)</span>th atom
based on Eq.<a class="reference internal" href="#equation-eq-phi">(6)</a>.
Since atom pairs are now understood, we
suppress the
index <span class="math notranslate nohighlight">\(i\)</span> in <span class="math notranslate nohighlight">\(d^i\)</span> and index <span class="math notranslate nohighlight">\(j\)</span> in <span class="math notranslate nohighlight">\(F^j\)</span>  for  forces in Eq. <a class="reference internal" href="#equation-eq-phi">(6)</a>.
We let the exact force <span class="math notranslate nohighlight">\(\vec{F}_k\)</span>
to differ from the approximate force <span class="math notranslate nohighlight">\(\vec{f}_k\)</span>
by an error term <span class="math notranslate nohighlight">\(\lambda \vec{\epsilon}_k\)</span> that
measures the intrinsic inaccuracies where</p>
<div class="math notranslate nohighlight">
\[
\vec{f}_k = \vec{F}_k +  \lambda\vec{\epsilon}_k, \ \ k = 1, 2, 3
\]</div>
<p>The calculated force constant block with <span class="math notranslate nohighlight">\(d\)</span>
is given by</p>
<p>Eqnarray here!</p>
<div class="math notranslate nohighlight">
\[
Eqnarray
\]</div>
<p>where <span class="math notranslate nohighlight">\(\Phi_e\)</span> is the exact force constant matrix and
<span class="math notranslate nohighlight">\(\epsilon = [\vec{\epsilon}_1 | \vec{\epsilon}_2 | \vec{\epsilon}_3]\)</span>.
Eq.~\ref{eq:Phid}
clearly shows that the error can be attributed by the
intrinsic inaccuracy of the force and
the inverse of <span class="math notranslate nohighlight">\(d\)</span>, which could potentially be
large if <span class="math notranslate nohighlight">\(d\)</span> is near singular.
In the absence of the exact force constant <span class="math notranslate nohighlight">\(\Phi_e\)</span> to calculate errors
we rely on</p>
<div class="math notranslate nohighlight">
\[
\phi_d  - \phi_{d_0} = \epsilon ( d^{-1} - d_0^{-1})
\label{eq:Err}
\]</div>
<p>where <span class="math notranslate nohighlight">\(d_0\)</span> is chosen to be with the largest possible <span class="math notranslate nohighlight">\(V\)</span>.
We will study the inaccuracy of
the calculated force constant as a function of <span class="math notranslate nohighlight">\(V\)</span>
in the next section.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="results">
<h1>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h1>
<p>\label{sec:results}
To confirm the methodology outline above, we
carry out density-functional theory (DFT) calculations within the local density
approximation, with projector augmented-wave (PAW) pseudopotential
as implemented in the Vienna Ab initio Simulation Package (VASP)
<span id="id34">[<a class="reference internal" href="#id183">KFurthmuller96</a>]</span> on a generic system of silicon.
We use a 2-atom primitive rhombohedral cell
and a <span class="math notranslate nohighlight">\(3\times 3\times 3\)</span> supercell for the phonon calculations.
The cutoff energy for the plane-wave basis set is
307~eV. We use a <span class="math notranslate nohighlight">\(3\times 3\times 3\)</span>
<span class="math notranslate nohighlight">\(k\)</span> mesh for the supercell calculations.
The magnitude of the displacement <span class="math notranslate nohighlight">\(\lambda \)</span> is <span class="math notranslate nohighlight">\(0.015\)</span>~\AA.
Because of the presence of a <span class="math notranslate nohighlight">\(C_3\)</span> rotation with its rotation axis
along the <span class="math notranslate nohighlight">\((1,1,1)^T\)</span> direction in the Cartesian
coordinates and another <span class="math notranslate nohighlight">\(C_2\)</span>
operation in Si just one displacement is
sufficient for a central difference scheme for the phonon calculations.
However, since we want to study the effect of <span class="math notranslate nohighlight">\(V\)</span> on the
phonon dispersions, we will still utilize <span class="math notranslate nohighlight">\(C_3\)</span> in
the <span class="math notranslate nohighlight">\((1,1,1)^T\)</span> direction to rotate <span class="math notranslate nohighlight">\(\vec{d}_1 = (x,y,y)^T\)</span>
that results in just one displacement
if the forward difference scheme is used. However another
displacement in the negative
direction is needed for a central difference scheme
since the <span class="math notranslate nohighlight">\(C_2\)</span> operation is now no longer able to map
<span class="math notranslate nohighlight">\(\vec{d}_1\)</span> to <span class="math notranslate nohighlight">\(-\vec{d}_1\)</span>.
Under <span class="math notranslate nohighlight">\(C_3\)</span> with its rotation axis in <span class="math notranslate nohighlight">\((1,1,1)^T\)</span>, we have
<span class="math notranslate nohighlight">\(\vec{d}_2 = (y, x,y)\)</span>, and <span class="math notranslate nohighlight">\( \vec{d}_3 = (y,y,x)\)</span>. This gives
<span class="math notranslate nohighlight">\(V = x^3 - 3xy^2 +2y^3\)</span>. With the constraint on the
magnitude of <span class="math notranslate nohighlight">\(\vec{d}_1\)</span>, which gives <span class="math notranslate nohighlight">\(2x^2 + y^2 = 1\)</span>,
we solve for
<span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> using a Newton-Raphson scheme for a predetermined <span class="math notranslate nohighlight">\(V\)</span>. We notice that
<span class="math notranslate nohighlight">\(V \rightarrow 0\)</span> as
<span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> go to <span class="math notranslate nohighlight">\(\frac{1}{\sqrt{3}}\)</span>.</p>
<p>We investigate the error of the force constants
as measured by the Frobenius norm  <span class="math notranslate nohighlight">\(||\phi_d - \phi_{d_0}||_F \)</span>
as a function <span class="math notranslate nohighlight">\(V\)</span> using Eq.~\ref{eq:Err}. We use <span class="math notranslate nohighlight">\(\det d_0 = 1\)</span>.
\Fig~\ref{fig:2020-04-22-mpl-qphonon-det-gives-error-fit.pdf}
shows the error of the force constants
linearly increases with decreasing <span class="math notranslate nohighlight">\(V = \det d\)</span> .</p>
<p>For an estimate of <span class="math notranslate nohighlight">\(\epsilon \)</span> in Eq.~\ref{eq:Err} without a full
knowledge of the error of the induced forces, we proceed
by assuming <span class="math notranslate nohighlight">\(\epsilon= \epsilon_0 J\)</span>, which
is characterized by a single
error parameter <span class="math notranslate nohighlight">\(\epsilon_0\)</span> and an appropriate <span class="math notranslate nohighlight">\(J\)</span> matrix. Our
aim is to
estimate  <span class="math notranslate nohighlight">\(\epsilon_0\)</span> that measures the inaccuracy of the force by
fitting the RHS of Eq.~\ref{eq:Err}.
We observe that
in the limit when <span class="math notranslate nohighlight">\(V \)</span> is very small, the three displacement vectors
<span class="math notranslate nohighlight">\(\vec{d}_1\)</span>, <span class="math notranslate nohighlight">\(\vec{d}_2\)</span>, and <span class="math notranslate nohighlight">\(\vec{d}_3\)</span> become closer and closer
to one another and converge to
<span class="math notranslate nohighlight">\(\frac{1}{\sqrt{3}}(1,1,1)^T\)</span>.
To maximize error it is therefore reasonable to assume
<span class="math notranslate nohighlight">\(\vec{\epsilon}_1 = \epsilon_0 (1,-1,-1)^T\)</span>,
<span class="math notranslate nohighlight">\(\vec{\epsilon}_2 = \epsilon_0 (-1,1,-1)^T\)</span>, and <span class="math notranslate nohighlight">\(
\vec{\epsilon}_3 = \epsilon_0 (-1,-1,1)^T\)</span>. Under such assumption and
with Eq~\ref{eq:Err} we obtain a rather good fit and deduce <span class="math notranslate nohighlight">\(\epsilon_0 = 3.7\times 10^{-4} \)</span>~eV/\AA<span class="math notranslate nohighlight">\(^2\)</span>.
This in turn gives a reasonable estimate of the force inaccuracy of <span class="math notranslate nohighlight">\(\lambda \epsilon_0 = 5.6\times 10^{-6}\)</span>~eV/\AA.
\Fig~\ref{fig:2020-04-24-Si-Phonon-Det-1d-5-and-Det-1d-6.pdf} shows  phonon dispersions
with different <span class="math notranslate nohighlight">\(V\)</span> values.
Noticeable differences in phonon dispersions are observed when <span class="math notranslate nohighlight">\(V \)</span> reaches <span class="math notranslate nohighlight">\(10^{-6}\)</span>.</p>
<div class="figure align-default" id="id626">
<img alt="_images/2020-04-22-mpl-qphonon-det-gives-error-fit.png" src="_images/2020-04-22-mpl-qphonon-det-gives-error-fit.png" />
<p class="caption"><span class="caption-number">Fig. 1 </span><span class="caption-text">The error (filled triangle) characterized
by the Frobenius norm of the force constant block <span class="math notranslate nohighlight">\(\phi_d  - \phi_{d_0}\)</span> in Eq.~\ref{eq:Err}
as a function <span class="math notranslate nohighlight">\(V = \det d\)</span>. The fitting form according to the RHS of Eq.~\ref{eq:Err} gives
<span class="math notranslate nohighlight">\(\epsilon_0 = 3.7\times 10^{-4}\)</span>~eV/\AA<span class="math notranslate nohighlight">\(^2\)</span>.</span><a class="headerlink" href="#id626" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id627">
<img alt="_images/2020-04-24-Si-Phonon-Det-1d-5-and-Det-1d-6.png" src="_images/2020-04-24-Si-Phonon-Det-1d-5-and-Det-1d-6.png" />
<p class="caption"><span class="caption-number">Fig. 2 </span><span class="caption-text">(a) The comparison of phonon dispersions obtained with <span class="math notranslate nohighlight">\(V = 10^{-5}\)</span> and <span class="math notranslate nohighlight">\(V=1\)</span>.  (b) The comparison of phonon dispersions obtained with <span class="math notranslate nohighlight">\(V = 10^{-6}\)</span> and <span class="math notranslate nohighlight">\(V=1\)</span>.</span><a class="headerlink" href="#id627" title="Permalink to this image">¶</a></p>
</div>
<p>We select four representative systems to perform more phonon calculations.
For each system, we first carry out a phonon calculation by using
the symmetry-adapted atomic displacements.
Using identical computational parameters
(i.e., energy cutoff, <span class="math notranslate nohighlight">\(k\)</span> mesh, etc), we carry out a second phonon calculation by displacing
each inequivalent atom in the <span class="math notranslate nohighlight">\(x+\)</span>, <span class="math notranslate nohighlight">\(x-\)</span>, <span class="math notranslate nohighlight">\(y+\)</span>, <span class="math notranslate nohighlight">\(y-\)</span>, <span class="math notranslate nohighlight">\(z+\)</span>, and <span class="math notranslate nohighlight">\(z-\)</span> along the Cartesian axes.
The results for hexagonal \mos{} [space group (SG) # 194],  trigonal \bise{} (SG # 166),
orthorhombic \sbs{} (SG # 62), and a 2D graphene sheet (SG # 191) are shown
in Figs. \ref{fig:mos}, \ref{fig:bise}, \ref{fig:sbs}, and ~\ref{fig:graphene},
respectively.
For all calculations the local density approximation is used,
and the magnitude of the displacement <span class="math notranslate nohighlight">\(\lambda \)</span> is <span class="math notranslate nohighlight">\(0.015\)</span>~\AA{}.
It is seen that the phonon dispersions
obtained with both displacement methods are essentially the same that indicate
a correct implementation of the proposed methodology.
The efficacy of the symmetry-adapted atomic displacement method is shown in Table II.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p></p></th>
<th class="head"><p>symmetry-adapted</p></th>
<th class="head"><p>6-displacement</p></th>
<th class="head"><p>All-displacemnt</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>MoS2</p></td>
<td><p>3</p></td>
<td><p>12</p></td>
<td><p>36</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Bi2Se3</p></td>
<td><p>5</p></td>
<td><p>18</p></td>
<td><p>30</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Sb2S3</p></td>
<td><p>20</p></td>
<td><p>30</p></td>
<td><p>120</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Graphene</p></td>
<td><p>1</p></td>
<td><p>6</p></td>
<td><p>12</p></td>
</tr>
</tbody>
</table>
<p>The numbers of atomic displacements required
for the symmetry-adapted, 6-displacement, and all-displacement methods.
The numbers of displacements for 6-displacement and all-displacement methods are <span class="math notranslate nohighlight">\(6 n_{\rm ineq}\)</span> and <span class="math notranslate nohighlight">\(6 n_{\rm c}\)</span>, respectively.
Here <span class="math notranslate nohighlight">\(n_{\rm ineq}\)</span> is the number of inequivalent atoms in the unit cell and <span class="math notranslate nohighlight">\(n_{\rm c}\)</span> is the number of atoms in the unit cell.</p>
<!---
\begin{table}
\begin{center}
\begin{tabular}{l|c|c|c}
\hline
  & symmetry- & $6$-  & all-  \\
  & adapted & displacement  & displacement  \\
\hline
\hline
\mos  & 3 & 12 &  36 \\
\bise & 5 & 18 & 30 \\
\sbs &  20 & 30 & 120 \\
Graphene & 1 &  6 & 12 \\
\hline
\end{tabular}
\end{center}
\caption{
}
\label{tab:number}
\end{table}
--->
<div class="figure align-default" id="id628">
<img alt="_images/2020-08-27-MoS2-Red-is-fmforces-Black-is-6displacement.png" src="_images/2020-08-27-MoS2-Red-is-fmforces-Black-is-6displacement.png" />
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text">Phonon dispersions of hexagonal \mos{} with <span class="math notranslate nohighlight">\(a=3.123\)</span> and <span class="math notranslate nohighlight">\(c = 12.087\)</span>~\AA{} obtained with
(a) symmetry-adapted atomic displacements and (b) six displacements for each of the two
inequivalent atoms.
The effect of longitudinal optical (LO) and transverse optical (TO) splitting<span id="id35">[<a class="reference internal" href="#id573">LCSG14</a>]</span> has been taken account.
A <span class="math notranslate nohighlight">\(3\times 3 \times 2\)</span> supercell is used. The cutoff energy for the plane-wave basis set
is <span class="math notranslate nohighlight">\(700\)</span>~eV.
A <span class="math notranslate nohighlight">\(k\)</span> mesh of <span class="math notranslate nohighlight">\(2 \times 2 \times 1\)</span> is
used for electronic relaxation.
The selected <span class="math notranslate nohighlight">\(\vec{q}\)</span> points (in <span class="math notranslate nohighlight">\(\vec{b}_1\)</span>, <span class="math notranslate nohighlight">\(\vec{b}_2\)</span>, and <span class="math notranslate nohighlight">\(\vec{b}_3\)</span>) are
<span class="math notranslate nohighlight">\(\Gamma=[0,0,0]\)</span>, <span class="math notranslate nohighlight">\(M= [0,\frac{1}{2},0]\)</span>, <span class="math notranslate nohighlight">\(L=[0,\frac{1}{2},\frac{1}{2}]\)</span>, and <span class="math notranslate nohighlight">\(H=[\frac{1}{3},\frac{1}{3},\frac{1}{2}]\)</span>.</span><a class="headerlink" href="#id628" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id629">
<img alt="_images/2020-08-28-Bi2Se3-fmforces-vs-6disp-LOTO.png" src="_images/2020-08-28-Bi2Se3-fmforces-vs-6disp-LOTO.png" />
<p class="caption"><span class="caption-number">Fig. 4 </span><span class="caption-text">Phonon dispersions of trigonal \bise{} with <span class="math notranslate nohighlight">\(a_r=9.621\)</span>~\AA,
<span class="math notranslate nohighlight">\(\alpha_r=24.64^\circ\)</span>, which corresponds to a conventional hexagonal cell of
<span class="math notranslate nohighlight">\(a= 4.105 \)</span> and <span class="math notranslate nohighlight">\(c=27.973\)</span>~\AA{}, obtained with (a) symmetry-adapted atomic displacements and (b) six displacements for each of the three
inequivalent atoms.
The effect of longitudinal optical (LO) and transverse optical (TO) splitting<span id="id36">[<a class="reference internal" href="#id573">LCSG14</a>]</span> has been taken account.
The supercell is <span class="math notranslate nohighlight">\(4 \times 4 \times 1\)</span> of the
conventional hexagonal unit cell. The cutoff energy for the plane-wave basis set is <span class="math notranslate nohighlight">\(423.2\)</span>~eV. A <span class="math notranslate nohighlight">\(k\)</span> mesh of <span class="math notranslate nohighlight">\(4 \times 4 \times 2\)</span> is
used for electronic relaxation.
The selected <span class="math notranslate nohighlight">\(\vec{q}\)</span> points (in <span class="math notranslate nohighlight">\(\vec{b}_1\)</span>, <span class="math notranslate nohighlight">\(\vec{b}_2\)</span>, and <span class="math notranslate nohighlight">\(\vec{b}_3\)</span>) are
<span class="math notranslate nohighlight">\(\Gamma=[0,0,0]\)</span>, <span class="math notranslate nohighlight">\(L= [\frac{1}{2},0,0]\)</span>, <span class="math notranslate nohighlight">\(B=[\eta,\frac{1}{2},1-\eta]\)</span>, and <span class="math notranslate nohighlight">\(Z=[\frac{1}{2},\frac{1}{2},\frac{1}{2}]\)</span>, where <span class="math notranslate nohighlight">\(\eta = (1+4 \cos \alpha_r)/ (2+ 4\cos\alpha_r)\)</span>.<span id="id37">[<a class="reference internal" href="#id498">SC10</a>]</span></span><a class="headerlink" href="#id629" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id630">
<img alt="_images/2020-08-27-Sb2S3-fmforces-vs-6disp-LOTO.png" src="_images/2020-08-27-Sb2S3-fmforces-vs-6disp-LOTO.png" />
<p class="caption"><span class="caption-number">Fig. 5 </span><span class="caption-text">Phonon dispersions of orthorhombic \sbs{} with <span class="math notranslate nohighlight">\(a=11.011\)</span>, <span class="math notranslate nohighlight">\(b= 3.812 \)</span>,
and <span class="math notranslate nohighlight">\(c=10.794\)</span>~\AA{}  obtained with (a) symmetry-adapted atomic displacements and (b) six displacements for each of the five
inequivalent atoms.
The effect of longitudinal optical (LO) and transverse optical (TO) splitting<span id="id38">[<a class="reference internal" href="#id573">LCSG14</a>]</span> has been taken account.
A <span class="math notranslate nohighlight">\(2\times 4 \times 2\)</span> supercell is used.
The cutoff energy for the plane-wave basis set is <span class="math notranslate nohighlight">\(323.3\)</span>~eV. A <span class="math notranslate nohighlight">\(k\)</span> mesh of <span class="math notranslate nohighlight">\(2 \times 3 \times 2\)</span> is
used for electronic relaxation.
The selected <span class="math notranslate nohighlight">\(\vec{q}\)</span> points (in <span class="math notranslate nohighlight">\(\vec{b}_1\)</span>, <span class="math notranslate nohighlight">\(\vec{b}_2\)</span>, and <span class="math notranslate nohighlight">\(\vec{b}_3\)</span>) are
<span class="math notranslate nohighlight">\(\Gamma=[0,0,0]\)</span>, <span class="math notranslate nohighlight">\(X=[\frac{1}{2},0,0]\)</span>, <span class="math notranslate nohighlight">\(S=[\frac{1}{2},\frac{1}{2},0]\)</span>,
<span class="math notranslate nohighlight">\(R=[\frac{1}{2},\frac{1}{2},\frac{1}{2}]\)</span>,
<span class="math notranslate nohighlight">\(T=[0,\frac{1}{2},\frac{1}{2}]\)</span>, and <span class="math notranslate nohighlight">\(Z=[0,0,\frac{1}{2}]\)</span>.</span><a class="headerlink" href="#id630" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id631">
<img alt="_images/2020-08-27-Graphene-Red-fmforces-vs-Black-6displacements.png" src="_images/2020-08-27-Graphene-Red-fmforces-vs-Black-6displacements.png" />
<p class="caption"><span class="caption-number">Fig. 6 </span><span class="caption-text">Phonon dispersions of 2D graphene sheet with <span class="math notranslate nohighlight">\(a=2.462\)</span>~\AA{} and a vacuum height of <span class="math notranslate nohighlight">\(12\)</span>~\AA{} obtained
with  (a) a symmetry-adapted atomic displacement and (b) six displacements for the only
inequivalent atom.
A <span class="math notranslate nohighlight">\(4\times 4 \times 1\)</span> supercell is used. The cutoff energy for the plane-wave basis set
is <span class="math notranslate nohighlight">\(500\)</span>~eV. A <span class="math notranslate nohighlight">\(k\)</span> mesh of <span class="math notranslate nohighlight">\(6 \times 6 \times 1\)</span> is
used for electronic relaxation.
The selected <span class="math notranslate nohighlight">\(\vec{q}\)</span> points (in <span class="math notranslate nohighlight">\(\vec{b}_1\)</span>, <span class="math notranslate nohighlight">\(\vec{b}_2\)</span>, and <span class="math notranslate nohighlight">\(\vec{b}_3\)</span>) are
<span class="math notranslate nohighlight">\(\Gamma=[0,0,0]\)</span>, <span class="math notranslate nohighlight">\(M= [0,\frac{1}{2},0]\)</span>, and <span class="math notranslate nohighlight">\(K = [\frac{1}{3},\frac{1}{3},0]\)</span>.</span><a class="headerlink" href="#id631" title="Permalink to this image">¶</a></p>
</div>
<!---
\label{fig:graphene}
\end{figure}
--->
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="conclusion">
<h1>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h1>
<p>\label{sec:conclusion}
In summary, we have proposed
a systematic displacement method that
guarantees a theoretical optimal volume <span class="math notranslate nohighlight">\(V\)</span>
spanned by the displacement
vectors to minimize possible severe roundoff errors
for lattice dynamical studies.
The concepts of the star of <span class="math notranslate nohighlight">\(k\)</span> and the group of <span class="math notranslate nohighlight">\(k\)</span> that
are originally defined in the reciprocal space have been
extended to real space
to facilitate a practical implementation of the method that is
readily applied to all 32 crystallographic point groups
and all 230 space groups.
The method generates a
minimal set of irreducible displacement vectors to
keep the number of independent force calculations to a minimum.
The error in the calculated
force constants is shown to explicitly depend on the
inverse of the volume <span class="math notranslate nohighlight">\(V\)</span> spanned by the displacement directions and the
intrinsic accuracy in the induced forces.
This justified the use of the Cartesian coordinates rather
than the fractional coordinates to optimize <span class="math notranslate nohighlight">\(V\)</span>.
Several test systems have been used to illustrate the method.
The method is shown to be very effective in dealing
cells with a large aspect ratio due to a huge difference in lattice parameters, cells with a large
vacuum separation, and
cells that are very oblique due to an unconventional choice of a primitive cell.
We expect the strategies employed in this paper could be extended to
deal with higher order interatomic interactions for efficiency and accuracy.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="acknowledgment">
<h1>Acknowledgment<a class="headerlink" href="#acknowledgment" title="Permalink to this headline">¶</a></h1>
<p>We acknowledge fruitful discussions with J. F. Kong.
We thank the National Supercomputing Center, Singapore (NSCC) and A*STAR Computational Resource Center,
Singapore (ACRC) for computing resources. This work is
supported by RIE2020 Advanced Manufacturing and Engineering (AME) Programmatic Grant No A1898b0043.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="appendix">
<h1>Appendix<a class="headerlink" href="#appendix" title="Permalink to this headline">¶</a></h1>
<p>Investigation of the determinant of <span class="math notranslate nohighlight">\(d\)</span></p>
<p>We consider a generic example of \sbs{} crystal with
space group of  <span class="math notranslate nohighlight">\(Pnma\)</span> (SG # <span class="math notranslate nohighlight">\(62\)</span>) which has
an orthorhombic cell.
We shall investigate the determinant of <span class="math notranslate nohighlight">\(d\)</span> (see Eq.~\ref{eq:dmat})
as a function of cell dimensions <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, and <span class="math notranslate nohighlight">\(c\)</span>.
For a general discussion we
choose a primitive cell with <span class="math notranslate nohighlight">\(\vec{a}_1 = a\vec{i} + nb \vec{j}\)</span>, <span class="math notranslate nohighlight">\(\vec{a}_2 = b\vec{j}\)</span>, and
<span class="math notranslate nohighlight">\(\vec{a}_3 = c \vec{k}\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is an integer. <span class="math notranslate nohighlight">\(\vec{i}\)</span>, <span class="math notranslate nohighlight">\(\vec{j}\)</span>, and <span class="math notranslate nohighlight">\(\vec{k}\)</span> are
unit vectors in the Cartesian directions. First we
consider <span class="math notranslate nohighlight">\(n=0\)</span> that
corresponds to the conventional primitive cell.</p>
<p>For \sbs{} crystal, all five inequivalent
atoms occupy the <span class="math notranslate nohighlight">\(4c\)</span> Wyckoff position hence
we may just consider any one of them.
The site symmetry for the <span class="math notranslate nohighlight">\(4c\)</span> position
consists of just two elements:
\be
I =
\begin{pmatrix}
1 &amp;  0 &amp;  0 \
0 &amp;  1 &amp;  0 \
0 &amp;  0 &amp;  1 \
\end{pmatrix}
\ee
and
\be
m =
\begin{pmatrix}
1 &amp;  0 &amp;  0 \
0 &amp; -1 &amp;  0 \
0 &amp;  0 &amp;  1 \
\end{pmatrix}
\ee
which is a reflection across the <span class="math notranslate nohighlight">\(xz\)</span> plane.</p>
<p><span class="math notranslate nohighlight">\(\vec{g}_1\)</span> may be chosen to be <span class="math notranslate nohighlight">\((1,-1,0)^T\)</span> which will be mapped to
<span class="math notranslate nohighlight">\(\vec{g}_2 = (1,1,0)^T\)</span> under <span class="math notranslate nohighlight">\(m\)</span>.
A second independent displacement is <span class="math notranslate nohighlight">\(\vec{g}_3 =
(0,0,1)^T\)</span>.</p>
<p>As discussed in the main text, the actual displacement in the Cartesian coordinates is
<span class="math notranslate nohighlight">\( \vec{d}_k^i =  \lambda \frac{A\vec{g_k}}{ | A\vec{g_k}   | }\)</span>, <span class="math notranslate nohighlight">\(k=1,2,3\)</span>.
We find
\bea
V &amp;=&amp; \det d \
&amp;=&amp; \frac{ \det A} { |A\vec{g}_1 | |A\vec{g}_2| |A\vec{g}_3|  }
\ &amp;=&amp;  \frac{  2 a b   }{  \sqrt{ a^2 + (n-1)^2 b^2    }   \sqrt{  a^2 + (n+1)^2 b^2   }   }
\eea
while the angle <span class="math notranslate nohighlight">\(\theta\)</span> between
the displacements <span class="math notranslate nohighlight">\(\vec{d}^i_1\)</span> and <span class="math notranslate nohighlight">\(\vec{d}_2^i\)</span>
satisfies
\be
\cos \theta = \frac{  a^2 + (n^2 -1 ) b^2   }{       \sqrt{ a^2 + (n-1)^2 b^2    }   \sqrt{  a^2 + (n+1)^2 b^2   }     }
\ee</p>
<p>When <span class="math notranslate nohighlight">\(n=0\)</span>, we find <span class="math notranslate nohighlight">\(V = \frac{2ab}{a^2 + b^2}\)</span> (therefore <span class="math notranslate nohighlight">\(V \rightarrow 2 (a/b)^{-1} \)</span> for <span class="math notranslate nohighlight">\(a \gg b\)</span>)
and <span class="math notranslate nohighlight">\(\cos \theta =
\frac{a^2 - b^2}{a^2 + b^2}\)</span>. The last result
is equivalent to a simpler expression
of <span class="math notranslate nohighlight">\(\tan^{-1} \frac{\theta}{2}  = \frac{b}{a}\)</span>, consistent
with the fact that the two displacements are <span class="math notranslate nohighlight">\((a, -b,0)^T\)</span> and <span class="math notranslate nohighlight">\((a,b,0)^T\)</span> in
the Cartesian coordinates.
If <span class="math notranslate nohighlight">\(a\)</span> is much larger than <span class="math notranslate nohighlight">\(b\)</span>, then <span class="math notranslate nohighlight">\(V\)</span> decreases as <span class="math notranslate nohighlight">\(\frac{2b}{a}\)</span>
to zero while <span class="math notranslate nohighlight">\(\cos \theta\)</span> approaches <span class="math notranslate nohighlight">\(1\)</span> since the two displacements
<span class="math notranslate nohighlight">\(\vec{d}_1^i\)</span> and <span class="math notranslate nohighlight">\(\vec{d}_2^i\)</span>
are almost parallel.</p>
<p>Next we discuss the effect of <span class="math notranslate nohighlight">\(n \ne 0\)</span>.
The site symmetry operations become<span id="id39">[<a class="reference internal" href="#id537">NA16</a>]</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
I = 
  \begin{pmatrix}
       1 &amp;  0 &amp;  0 \\
       0 &amp;  1 &amp;  0 \\
       0 &amp;  0 &amp;  1 \\
  \end{pmatrix}
\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
m = 
  \begin{pmatrix}
       1 &amp;  0 &amp;  0 \\
       -2n &amp; -1 &amp;  0 \\
       0 &amp;  0 &amp;  1 \\
  \end{pmatrix}
\end{split}\]</div>
<p>If <span class="math notranslate nohighlight">\(\vec{g}_1 = (1,0,0)^T\)</span> is used, the <span class="math notranslate nohighlight">\(m\)</span> operation on <span class="math notranslate nohighlight">\(\vec{g}_1\)</span> gives
<span class="math notranslate nohighlight">\(\vec{g}_2 = (1,-2n,0)^T\)</span>. A second independent displacement is
<span class="math notranslate nohighlight">\(\vec{g}_3 = (0,0,1)^T\)</span>.
For a simple analysis, we set <span class="math notranslate nohighlight">\(a=b\)</span>.
For large <span class="math notranslate nohighlight">\(n\)</span>, we find <span class="math notranslate nohighlight">\(V\)</span> approaches <span class="math notranslate nohighlight">\(-\frac{2}{n} \)</span>, while
<span class="math notranslate nohighlight">\(\cos\theta \)</span> approaches <span class="math notranslate nohighlight">\(-1\)</span>, which means the displacement <span class="math notranslate nohighlight">\(\vec{d}_1^i\)</span>
approaches <span class="math notranslate nohighlight">\(-\vec{d}_2^i\)</span>.</p>
<p>This shows that using displacement directions in the form of nonzero <span class="math notranslate nohighlight">\((e_1,e_2,e_3)^T\)</span>
where <span class="math notranslate nohighlight">\(e_i= 0,\pm 1\)</span>, <span class="math notranslate nohighlight">\(i=1,2,3\)</span> may not be an optimal choice.</p>
<p id="id40"><dl class="citation">
<dt class="label" id="id425"><span class="brackets"><a class="fn-backref" href="#id16">AWC97</a></span></dt>
<dd><p>G. J. Ackland, M. C. Warren, and S. J. Clark. Practical methods in ab initio lattice dynamics. <em>J. Phys.: Condens. Matter</em>, 9:7861, 1997.</p>
</dd>
<dt class="label" id="id415"><span class="brackets"><a class="fn-backref" href="#id16">Alfe09</a></span></dt>
<dd><p>Dario Alfè. Phon: a program to calculate phonons using the small displacement method. <em>Comput. Phys. Comm.</em>, 180:2622, 2009.</p>
</dd>
<dt class="label" id="id557"><span class="brackets"><a class="fn-backref" href="#id9">All20</a></span></dt>
<dd><p>Philip B. Allen. Theory of thermal expansion: quasi-harmonic approximation and corrections from quasi-particle renormalization. <em>Mod. Phys. Lett. B</em>, 34:2050025, 2020.</p>
</dd>
<dt class="label" id="id443"><span class="brackets"><a class="fn-backref" href="#id12">ALebegueR16</a></span></dt>
<dd><p>B. Arnaud, S. Lebègue, and G. Raffy. Anisotropic thermal expansion of bismuth from first principles. <em>Phys. Rev. B</em>, 93:094106, 2016.</p>
</dd>
<dt class="label" id="id370"><span class="brackets"><a class="fn-backref" href="#id19">BdeGironcoliDalCorsoG01</a></span></dt>
<dd><p>S. Baroni, S. de Gironcoli, A. Dal Corso, and P. Giannozzi. Phonons and related crystal properties from density-functional perturbation theory. <em>Rev. Mod. Phys.</em>, 73:515, 2001.</p>
</dd>
<dt class="label" id="id128"><span class="brackets"><a class="fn-backref" href="#id1">BH56</a></span></dt>
<dd><p>M. Born and K. Huang. <em>Dynamical Theory of Crystal Lattices</em>. Oxford University Press, London, 1956.</p>
</dd>
<dt class="label" id="id135"><span class="brackets">Bur85</span><span class="fn-backref">(<a href="#id25">1</a>,<a href="#id30">2</a>)</span></dt>
<dd><p>G. Burns. <em>Solid State Physics</em>. Academic Press, Orlando, Florida, 1985.</p>
</dd>
<dt class="label" id="id340"><span class="brackets">CXL+14</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id32">2</a>)</span></dt>
<dd><p>Wee Kiang Chong, G. Xing, Y. Liu, E. L. Gui, Qing Zhang, Q. Xiong, N. Mathews, Chee Kwan Gan, and T. C. Sum. Direct measurement of coherent phonon dynamics in solution-processed stibnite thin films. <em>Phys. Rev. B</em>, 90:035208, 2014.</p>
</dd>
<dt class="label" id="id479"><span class="brackets"><a class="fn-backref" href="#id15">CHB+13</a></span></dt>
<dd><p>Stefano Curtarolo, Gus L. W. Hart, Marco BuongiornoNardelli, Natalio Mingo, Stefano Sanvito, and Ohad Levy. The high-throughput highway to computational materials design. <em>Nature Mater.</em>, 12:191, 2013.</p>
</dd>
<dt class="label" id="id134"><span class="brackets">DDJ08</span><span class="fn-backref">(<a href="#id24">1</a>,<a href="#id25">2</a>,<a href="#id28">3</a>)</span></dt>
<dd><p>M. S. Dresselhaus, G. Dresselhaus, and Ado Jorio. <em>Group theory: Application to the physics of condensed matter</em>. Springer-Verlag, Berlin, Heidelberg, 2008.</p>
</dd>
<dt class="label" id="id467"><span class="brackets"><a class="fn-backref" href="#id17">Fey39</a></span></dt>
<dd><p>R. P. Feynman. Forces in molecules. <em>Phys. Rev.</em>, 56:340, 1939.</p>
</dd>
<dt class="label" id="id553"><span class="brackets"><a class="fn-backref" href="#id21">FKCM19</a></span></dt>
<dd><p>Lyuwen Fu, Mordechai Kornbluth, Zhengqian Cheng, and Chris A. Marianetti. Group theoretical approach to computing phonons and their interactions. <em>Phys. Rev. B</em>, 100:014303, 2019.</p>
</dd>
<dt class="label" id="id559"><span class="brackets"><a class="fn-backref" href="#id27">GHP01</a></span></dt>
<dd><p>C. K. Gan, P. D. Haynes, and M. C. Payne. Preconditioned conjugate gradient method for the sparse generalized eigenvalue problem in electronic structure calculations. <em>Comput. Phys. Comm.</em>, 134:33, 2001.</p>
</dd>
<dt class="label" id="id571"><span class="brackets"><a class="fn-backref" href="#id12">GC19</a></span></dt>
<dd><p>Chee Kwan Gan and Kun Ting Eddie Chua. Large thermal anisotropy in monoclinic niobium trisulfide: a thermal expansion tensor study. <em>J. Phys.: Condens. Matter</em>, 31:265401, 2019.</p>
</dd>
<dt class="label" id="id148"><span class="brackets">GFK10</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id16">2</a>)</span></dt>
<dd><p>Chee Kwan Gan, Xiao Feng Fan, and Jer-Lai Kuo. Composition-temperature phase diagram of Be$_x$Zn$_1-x$O from first principles. <em>Comput. Mater. Sci.</em>, 49:S29, 2010.</p>
</dd>
<dt class="label" id="id570"><span class="brackets"><a class="fn-backref" href="#id12">GL18</a></span></dt>
<dd><p>Chee Kwan Gan and Ching Hua Lee. Anharmonic phonon effects on linear thermal expansion of trigonal bismuth selenide and antimony telluride crystals. <em>Comput. Mater. Sci.</em>, 151:49, 2018.</p>
</dd>
<dt class="label" id="id568"><span class="brackets"><a class="fn-backref" href="#id12">GL16</a></span></dt>
<dd><p>Chee Kwan Gan and Yu Yang Fredrik Liu. Direct calculation of the linear thermal expansion coefficients of MoS$_2$ via symmetry-preserving deformations. <em>Phys. Rev. B</em>, 94:134303, 2016.</p>
</dd>
<dt class="label" id="id567"><span class="brackets">GSL15</span><span class="fn-backref">(<a href="#id12">1</a>,<a href="#id32">2</a>)</span></dt>
<dd><p>Chee Kwan Gan, Jian Rui Soh, and Yun Liu. Large anharmonic effect and thermal expansion anisotropy of metal chalcogenides: the case of antimony sulfide. <em>Phys. Rev. B</em>, 92:235202, 2015.</p>
</dd>
<dt class="label" id="id309"><span class="brackets"><a class="fn-backref" href="#id33">GS10</a></span></dt>
<dd><p>Chee Kwan Gan and D. J. Srolovitz. First-principles study of graphene edge properties and flake shapes. <em>Phys. Rev. B</em>, 81:125445, 2010.</p>
</dd>
<dt class="label" id="id363"><span class="brackets"><a class="fn-backref" href="#id20">GBB+09</a></span></dt>
<dd><p>P. Giannozzi, S. Baroni, N. Bonini, M. Calandra, R. Car, C. Cavazzoni, D. Ceresoli, G. L. Chiarotti, M. Cococcioni, I. Dabo, Andrea Dal Corso, Stefano de Gironcoli, Stefano Fabris, Guido Fratesi, Ralph Gebauer, Uwe Gerstmann, Christos Gougoussis, Anton Kokalj, Michele Lazzeri, Layla Martin-Samos, Nicola Marzari, Francesco Mauri, Riccardo Mazzarello, Stefano Paolini, Alfredo Pasquarello, Lorenzo Paulatto, Carlo Sbraccia, Sandro Scandolo, Gabriele Sclauzero, Ari P Seitsonen, Alexander Smogunov, Paolo Umari, and Renata M. Wentzcovitch. Quantum Espresso: a modular and open-source software project for quantum simulations of materials. <em>J. Phys.: Condens. Matter</em>, 21:395502, 2009.</p>
</dd>
<dt class="label" id="id540"><span class="brackets"><a class="fn-backref" href="#id4">GCL+18</a></span></dt>
<dd><p>David Giovanni, Wee Kiang Chong, Yu Yang Fredrik Liu, Herlina Arianita Dewi, Tingting Yin, Yulia Lekina, Ze Xiang Shen, Nripan Mathews, Chee Kwan Gan, and Tze Chien Sum. Coherent spin and quasiparticle dynamics in solution-processed layered 2D lead halide perovskites. <em>Adv. Sci.</em>, 5:1800664, 2018.</p>
</dd>
<dt class="label" id="id59"><span class="brackets"><a class="fn-backref" href="#id5">Giu17</a></span></dt>
<dd><p>F. Giustino. Electron-phonon interactions from first-principles. <em>Rev. Mod. Phys.</em>, 89:015003, 2017.</p>
</dd>
<dt class="label" id="id41"><span class="brackets"><a class="fn-backref" href="#id19">Gon97</a></span></dt>
<dd><p>X. Gonze. First-principles responses of solids to atomic displacements and homogeneous electric fields: implementation of a conjugate-gradient algorithm. <em>Phys. Rev. B</em>, 55:10337, 1997.</p>
</dd>
<dt class="label" id="id43"><span class="brackets"><a class="fn-backref" href="#id20">GAA+09</a></span></dt>
<dd><p>X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval, D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi, S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet, M.J.T. Oliveir, G. Onidab, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf, M. Torrent, M.J. Verstraete, G. Zerah, and J.W. Zwanziger. ABINIT: first-principles approach to material and nanosystem properties. <em>Comput. Phys. Comm.</em>, 180:2582, 2009.</p>
</dd>
<dt class="label" id="id548"><span class="brackets"><a class="fn-backref" href="#id11">GStevanovicT17</a></span></dt>
<dd><p>Prashun Gorai, Vladan Stevanović, and Eric Toberer. Computationally guided discovery of thermoelectric materials. <em>Nature Rev. Mat.</em>, 2:17053, 2017.</p>
</dd>
<dt class="label" id="id127"><span class="brackets"><a class="fn-backref" href="#id7">Gri99</a></span></dt>
<dd><p>G. Grimvall. <em>Thermophysical Properties of Materials</em>. Elsevier Science B.V., Amsterdam, The Netherlands, 1999.</p>
</dd>
<dt class="label" id="id384"><span class="brackets"><a class="fn-backref" href="#id23">HahnEd06</a></span></dt>
<dd><p>Th. Hahn(Ed.). <em>International Tables for Crystallography (2006). Vol. A, Space-group symmetry</em>. Chester, International Union of Crystallography, 2006.</p>
</dd>
<dt class="label" id="id423"><span class="brackets"><a class="fn-backref" href="#id16">KFurthmullerH95</a></span></dt>
<dd><p>G. Kresse, J. Furthmüller, and J. Hafner. Ab initio force constant approach to phonon dispersion relations of diamond and graphite. <em>Europhys. Lett.</em>, 32:729, 1995.</p>
</dd>
<dt class="label" id="id183"><span class="brackets"><a class="fn-backref" href="#id34">KFurthmuller96</a></span></dt>
<dd><p>G. Kresse and J. Furthmüller. Efficiency of ab-initio total energy calculations for metals and semiconductors using a plane-wave basis set. <em>Comput. Mater. Sci.</em>, 6:15, 1996.</p>
</dd>
<dt class="label" id="id569"><span class="brackets"><a class="fn-backref" href="#id13">LG17</a></span></dt>
<dd><p>Ching Hua Lee and Chee Kwan Gan. Anharmonic interatomic force constants and thermal conductivity from Grüneisen parameters: an application to graphene. <em>Phys. Rev. B</em>, 96:035105, 2017.</p>
</dd>
<dt class="label" id="id573"><span class="brackets">LCSG14</span><span class="fn-backref">(<a href="#id26">1</a>,<a href="#id29">2</a>,<a href="#id32">3</a>,<a href="#id35">4</a>,<a href="#id36">5</a>,<a href="#id38">6</a>)</span></dt>
<dd><p>Yun Liu, K. T. E. Chua, T. C. Sum, and Chee Kwan Gan. First-principles study of the lattice dynamics of Sb$_2$S$_3$. <em>Phys. Chem. Chem. Phys.</em>, 16:345, 2014.</p>
</dd>
<dt class="label" id="id514"><span class="brackets"><a class="fn-backref" href="#id18">LWM15</a></span></dt>
<dd><p>Jonathan H. Lloyd-Williams and Bartomeu Monserrat. Lattice dynamics and electron-phonon coupling calculations using nondiagonal supercells. <em>Phys. Rev. B</em>, 92:184301, 2015.</p>
</dd>
<dt class="label" id="id562"><span class="brackets"><a class="fn-backref" href="#id11">MKB16</a></span></dt>
<dd><p>Georg K. H. Madsen, Ankita Katre, and Chandan Bera. Calculating the thermal conductivity of the silicon clathrates using the quasi-harmonic approximation. <em>Phys. Stat. Sol. (A)</em>, 213:802, 2016.</p>
</dd>
<dt class="label" id="id563"><span class="brackets"><a class="fn-backref" href="#id9">MC20</a></span></dt>
<dd><p>Cristiano Malica and Andrea Dal Corso. Quasi-harmonic temperature dependent elastic constants: applications to silicon, aluminum, and silver. <em>J. Phys.: Condens. Matter</em>, 32:315902, 2020.</p>
</dd>
<dt class="label" id="id429"><span class="brackets"><a class="fn-backref" href="#id8">MM05</a></span></dt>
<dd><p>Nicolas Mounet and Nicola Marzari. First-principles determination of the structural, vibrational and thermodynamic properties of diamond, graphite, and derivatives. <em>Phys. Rev. B</em>, 71:205214, 2005.</p>
</dd>
<dt class="label" id="id472"><span class="brackets"><a class="fn-backref" href="#id7">MRMN03</a></span></dt>
<dd><p>A. Mujica, Angel Rubio, A. Munoz, and R. J. Needs. High-pressure phases of group-IV, III-V, and II-VI compounds. <em>Rev. Mod. Phys.</em>, 75:863, 2003.</p>
</dd>
<dt class="label" id="id537"><span class="brackets"><a class="fn-backref" href="#id39">NA16</a></span></dt>
<dd><p>Massimo Nespolo and Mois I. Aroyo. The crystallographic chameleon: when space groups change skin. <em>Acta Cryst. A</em>, 72:523, 2016.</p>
</dd>
<dt class="label" id="id471"><span class="brackets"><a class="fn-backref" href="#id15">ORJ+13</a></span></dt>
<dd><p>Shyue Ping Ong, William Davidson Richards, Anubhav Jain, Geoffroy Hautier, Michael Kocher, Shreyas Cholia, Dan Gunter, Vincent L. Chevrier, Kristin A. Persson, and Gerbrand Ceder. Python materials genomics (pymatgen): a robus, open-source python library for material analysis. <em>Comput. Mater. Sci.</em>, 68:314, 2013.</p>
</dd>
<dt class="label" id="id426"><span class="brackets"><a class="fn-backref" href="#id22">Par18</a></span></dt>
<dd><p>K. Parlinski. Ab initio determination of anharmonic phonon peaks. <em>Phys. Rev. B</em>, 98:054305, 2018.</p>
</dd>
<dt class="label" id="id427"><span class="brackets"><a class="fn-backref" href="#id16">PLK97</a></span></dt>
<dd><p>K. Parlinski, Z. -Q. Li, and Y. Kawazoe. First-principles determination of the soft mode in cubic ZrO$_2$. <em>Phys. Rev. Lett.</em>, 78:4063, 1997.</p>
</dd>
<dt class="label" id="id212"><span class="brackets"><a class="fn-backref" href="#id27">PTA+92</a></span></dt>
<dd><p>M. C. Payne, M. P. Teter, D. C. Allan, T. A. Arias, and J. D. Joannopoulos. Iterative minimization techniques for ab initio total-energy calculations: molecular dynamics and conjugate gradients. <em>Rev. Mod. Phys.</em>, 64:1045, 1992.</p>
</dd>
<dt class="label" id="id566"><span class="brackets"><a class="fn-backref" href="#id14">PDM+18</a></span></dt>
<dd><p>Guido Petretto, Shyam Dwaraknath, Henrique P.C. Miranda, Donald Winston, Matteo Giantomassi, Michiel J. van Setten, Xavier Gonze, Kristin A. Persson, Geoffroy Hautier, and Gian-Marco Rignanese. Data descriptor: high-throughput density-functional perturbation theory phonons for inorganic materials. <em>Scientific Data</em>, 5:180065, 2018.</p>
</dd>
<dt class="label" id="id470"><span class="brackets"><a class="fn-backref" href="#id15">PCS+16</a></span></dt>
<dd><p>Giovanni Pizzi, Andrea Cepellotti, Riccardo Sabatini, Nicola Marzari, and Boris Kozinsky. Aiida: automated interactive infrastructure and database for computational science. <em>Comput. Mater. Sci.</em>, 111:218, 2016.</p>
</dd>
<dt class="label" id="id530"><span class="brackets"><a class="fn-backref" href="#id12">Rom17</a></span></dt>
<dd><p>Carl P. Romao. Anisotropic thermal expansion in flexible materials. <em>Phys. Rev. B</em>, 96:134113, 2017.</p>
</dd>
<dt class="label" id="id498"><span class="brackets"><a class="fn-backref" href="#id37">SC10</a></span></dt>
<dd><p>Wahyu Setyawan and Stefano Curtarolo. High-throughput electronic band structure calculations: challenges and tools. <em>Comput. Mater. Sci.</em>, 49:299, 2010.</p>
</dd>
<dt class="label" id="id53"><span class="brackets"><a class="fn-backref" href="#id11">ST08</a></span></dt>
<dd><p>G. Jeffrey Snyder and Eric S. Toberer. Complex thermoelectric materials. <em>Nature Mater.</em>, 7:105, 2008.</p>
</dd>
<dt class="label" id="id422"><span class="brackets"><a class="fn-backref" href="#id16">TT15</a></span></dt>
<dd><p>A Togo and I Tanaka. First principles phonon calculations in materials science. <em>Scr. Mater.</em>, 108:1, 2015.</p>
</dd>
<dt class="label" id="id419"><span class="brackets"><a class="fn-backref" href="#id14">Tog20a</a></span></dt>
<dd><p>Atsushi Togo. Phonon database at Kyoto University. <span><a class="reference external" href="#"></a></span>http://phonondb.mtl.kyoto-u.ac.jp, 2020.</p>
</dd>
<dt class="label" id="id420"><span class="brackets"><a class="fn-backref" href="#id16">Tog20b</a></span></dt>
<dd><p>Atsushi Togo. Phonopy. <span><a class="reference external" href="#"></a></span>https://phonopy.github.io/phonopy, 2020.</p>
</dd>
<dt class="label" id="id372"><span class="brackets"><a class="fn-backref" href="#id6">TOT08</a></span></dt>
<dd><p>Atsushi Togo, Fumiyasu Oba, and Isao Tanaka. First-principles calculations of the ferroelastic transition between rutile-type and CaCl$_2$-type SiO$_2$ at high pressures. <em>Phys. Rev. B</em>, 78:134106, 2008.</p>
</dd>
<dt class="label" id="id524"><span class="brackets"><a class="fn-backref" href="#id10">TPL+14</a></span></dt>
<dd><p>Cormac Toher, Jose J. Plata, Ohad Levy, Maarten de Jong, Mark Asta, Marco BuongiornoNardelli, and Stefano Curtarolo. High-throughput computational screening of thermal conductivity, Debye temperature, and Grüneisen parameter using a quasiharmonic Debye model. <em>Phys. Rev. B</em>, 90:174107, 2014.</p>
</dd>
<dt class="label" id="id253"><span class="brackets"><a class="fn-backref" href="#id2">vdWC02</a></span></dt>
<dd><p>A. van de Walle and G. Ceder. The effect of lattice vibrations on substitutional alloy thermodynamics. <em>Rev. Mod. Phys.</em>, 74:11, 2002.</p>
</dd>
<dt class="label" id="id555"><span class="brackets"><a class="fn-backref" href="#id16">WCL14</a></span></dt>
<dd><p>Yi Wang, Long-Qing Chen, and Zi-Kui Liu. YPHON: a package for calculating phonons of polar materials. <em>Comput. Phys. Comm.</em>, 185:2950, 2014.</p>
</dd>
<dt class="label" id="id558"><span class="brackets"><a class="fn-backref" href="#id16">WSF+16</a></span></dt>
<dd><p>Yi Wang, Shun-Li Shang, Huazhi Fang, Zi-Kui Liu, and Long-Qing Chen. First-principles calculations of lattice dynamics and thermal properties of polar solids. <em>npj Comp. Mater.</em>, 2:16006, 2016.</p>
</dd>
<dt class="label" id="id350"><span class="brackets"><a class="fn-backref" href="#id4">ZLL+13</a></span></dt>
<dd><p>Y. Zhao, X. Luo, H. Li, J. Zhang, P. T. Araujo, C. K. Gan, J. Wu, H. Zhang, S. Y. Quek, M. S. Dresselhaus, and Q. H. Xiong. Interlayer brething and shear modes in few-trilayer MoS2 and WSe2. <em>Nano Lett.</em>, 13:1007, 2013.</p>
</dd>
<dt class="label" id="id61"><span class="brackets"><a class="fn-backref" href="#id31">ZCG+11</a></span></dt>
<dd><p>Y. Y. Zhao, K. T. E. Chua, Chee Kwan Gan, J. Zhang, B. Peng, Z. P. Peng, and Q. H. Xiong. Phonons in Bi$_2$S$_3$ nanostructures: raman scattering and first-principles studies. <em>Phys. Rev. B</em>, 84:205330, 2011.</p>
</dd>
<dt class="label" id="id565"><span class="brackets"><a class="fn-backref" href="#id3">ZKSV94</a></span></dt>
<dd><p>W. Zhong, R. D. King-Smith, and David Vanderbilt. Giant LO-TO splittings in perovskite ferroelectrics. <em>Phys. Rev. Lett.</em>, 72:3618, 1994.</p>
</dd>
</dl>
</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="title.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Displacement method</p>
        </div>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Chee K Gan<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>